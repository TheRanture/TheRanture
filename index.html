<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ranture</title>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Text&family=Lora&display=swap" rel="stylesheet" />
  <style>
    /* ==== FULL CSS START ==== */

    /* Reset and base styles */
    *, *::before, *::after {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: 'Lora', serif;
      background-color: #fff;
      color: #222;
      line-height: 1.5;
    }
    body.dark-mode {
      background-color: #121212;
      color: #ddd;
    }

    /* Header and toolbar */
    #header-toolbar-wrapper {
      position: fixed;
      top: 0;
      width: 100%;
      background-color: #f9f9f9;
      border-bottom: 1px solid #ccc;
      z-index: 9999;
    }
    body.dark-mode #header-toolbar-wrapper {
      background-color: #1e1e1e;
      border-color: #444;
    }
    header {
      padding: 0.5rem 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    header h1 {
      font-family: 'Crimson Text', serif;
      font-weight: 700;
      font-size: 2rem;
      margin: 0;
    }
    #motto {
      font-style: italic;
      text-align: center;
      padding: 0 1rem 0.75rem;
      font-size: 1rem;
      color: #555;
    }
    body.dark-mode #motto {
      color: #aaa;
    }

    /* Search container */
    #search-container {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 1rem 1rem;
      gap: 0.5rem;
    }
    #search-toggle {
      background: none;
      border: none;
      cursor: pointer;
      color: inherit;
      padding: 0;
      display: flex;
      align-items: center;
    }
    #search-bar {
      flex: 1;
      padding: 0.25rem 0.5rem;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      display: none;
    }
    body.dark-mode #search-bar {
      background-color: #222;
      border-color: #555;
      color: #ddd;
    }
    #clear-search {
      background: #ccc;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      font-weight: bold;
      line-height: 24px;
      text-align: center;
      cursor: pointer;
      display: none;
    }
    body.dark-mode #clear-search {
      background: #555;
      color: #eee;
    }
    #search-funny {
      font-style: italic;
      margin-top: 0.25rem;
      color: #888;
      text-align: center;
    }
    body.dark-mode #search-funny {
      color: #aaa;
    }

    /* Toolbar */
    #toolbar {
      display: flex;
      justify-content: center;
      border-top: 1px solid #ccc;
      border-bottom: 1px solid #ccc;
      background-color: #eee;
    }
    body.dark-mode #toolbar {
      background-color: #2a2a2a;
      border-color: #444;
    }
    .toolbar-btn {
      background: none;
      border: none;
      padding: 0.75rem 1rem;
      font-size: 1rem;
      cursor: pointer;
      color: #333;
      font-weight: 600;
      transition: background-color 0.3s;
    }
    .toolbar-btn:hover {
      background-color: #ddd;
    }
    body.dark-mode .toolbar-btn {
      color: #ccc;
    }
    body.dark-mode .toolbar-btn:hover {
      background-color: #444;
    }
    .toolbar-btn.active {
      border-bottom: 3px solid #007acc;
      font-weight: 700;
    }

    /* Main content */
    main#main-content {
      margin-top: 190px; /* header + toolbar height + margin */
      padding: 1rem;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Article previews */
    .article-preview {
      background-color: #f5f5f5;
      margin-bottom: 1rem;
      padding: 1rem;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .article-preview:hover {
      background-color: #e0e0e0;
    }
    body.dark-mode .article-preview {
      background-color: #2b2b2b;
    }
    body.dark-mode .article-preview:hover {
      background-color: #3c3c3c;
    }

    /* Full article content */
    #article-full-content {
      background-color: #fafafa;
      padding: 1rem;
      border-radius: 6px;
    }
    body.dark-mode #article-full-content {
      background-color: #222;
    }

    /* Torch styles */
    .torch {
      position: relative;
      width: 30px;
      height: 60px;
      margin: 20px;
    }
    .handle {
      position: absolute;
      bottom: 0;
      width: 10px;
      height: 40px;
      background: #663300;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 3px;
      box-shadow: inset 0 0 4px #422600;
    }
    .flame {
      position: absolute;
      left: 50%;
      bottom: 28px;
      transform-origin: bottom center;
      animation-name: flicker;
      animation-timing-function: ease-in-out;
      animation-iteration-count: infinite;
      border-radius: 50% / 70%;
      filter: drop-shadow(0 0 4px rgba(255, 140, 0, 0.7));
    }
    .flame:nth-child(1) {
      background: #FF6633;
    }
    .flame:nth-child(2) {
      background: #FF9933;
    }
    .flame:nth-child(3) {
      background: #FFD966;
    }
    @keyframes flicker {
      0%, 100% { transform: translateX(-50%) translateY(0) scale(1); opacity: 1; filter: brightness(1); }
      50% { transform: translateX(-52%) translateY(-3px) scale(1.1); opacity: 0.85; filter: brightness(1.1); }
    }

    /* Back to top button */
    #back-to-top {
      display: none;
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: #333;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1.2rem;
      z-index: 1000;
      user-select: none;
    }
    #back-to-top:hover {
      background: #555;
    }

    /* Footnote */
    #footnote {
      position: fixed;
      bottom: 5px;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 0.8rem;
      color: #666;
      opacity: 0;
      transition: opacity 1s ease;
      user-select: none;
      pointer-events: none;
    }
    body.dark-mode #footnote {
      color: #aaa;
    }

    /* Responsive tweaks */
    @media (max-width: 600px) {
      #header-toolbar-wrapper {
        font-size: 0.9rem;
      }
      main#main-content {
        margin-top: 150px;
        padding: 0.75rem;
      }
      .toolbar-btn {
        padding: 0.5rem 0.75rem;
        font-size: 0.9rem;
      }
    }

    /* ==== FULL CSS END ==== */
  </style>
</head>
<body>
  <button id="mode-toggle" class="torch-mode" aria-label="Toggle dark mode">
    <div class="torch">
      <div class="handle"></div>
      <!-- Flames will be dynamically added by JS -->
    </div>
  </button>

  <div id="header-toolbar-wrapper">
    <header>
      <h1>Ranture</h1>
    </header>
    <div id="motto">“I came, I saw, I ranted.”</div>
    <div id="search-container">
      <button id="search-toggle" aria-label="Toggle Search">
        <svg xmlns="http://www.w3.org/2000/svg" height="22" viewBox="0 0 24 24" width="22" fill="currentColor">
          <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zM10 14a4 4 0 110-8 4 4 0 010 8z" />
        </svg>
      </button>
      <input type="text" id="search-bar" placeholder="Search..." />
      <button id="clear-search" aria-label="Clear Search">×</button>
      <div id="search-funny"></div>
    </div>

    <nav id="toolbar">
      <button class="toolbar-btn active" data-page="articles">Articles</button>
      <button class="toolbar-btn" data-page="shorticles">Shorticles</button>
      <button class="toolbar-btn" data-page="books">Books</button>
      <button class="toolbar-btn" data-page="about">About</button>
    </nav>
  </div>

  <main id="main-content">
    <div id="articles-container">
      <!-- Article previews -->
      <div class="article-preview" data-file="article1.html">Article 1 preview</div>
      <div class="article-preview" data-file="article2.html">Article 2 preview</div>
      <!-- Add more previews as needed -->
    </div>
    <div id="article-full-content" style="display:none;"></div>
  </main>

  <button id="back-to-top" aria-label="Back to Top">↑ Top</button>
  <div id="footnote">Made possible by bad choices and good intentions.</div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      /* ==== FULL JS START ==== */

      // Clip shapes for flame — adjusted to non-egg shapes with jagged spikes
      const clipShapes = [
        'polygon(50% 0%, 58% 12%, 70% 32%, 62% 48%, 68% 70%, 50% 100%, 35% 68%, 42% 48%, 35% 28%, 45% 12%)',
        'polygon(50% 0%, 62% 14%, 74% 34%, 65% 52%, 70% 70%, 50% 98%, 30% 70%, 38% 52%, 30% 32%, 42% 14%)',
        'polygon(50% 0%, 65% 18%, 78% 38%, 70% 55%, 75% 75%, 50% 96%, 28% 75%, 32% 55%, 25% 38%, 38% 18%)'
      ];

      const torch = document.querySelector('.torch');
      if (torch) {
        for (let i = 0; i < 3; i++) {
          const flame = document.createElement('div');
          flame.classList.add('flame');
          const size = 10 + i * 8;
          flame.style.width = `${size}px`;
          flame.style.height = `${size * 1.4}px`;
          flame.style.background = i === 0 ? '#FF4500' : i === 1 ? '#FF8C00' : '#FFD700';
          flame.style.clipPath = clipShapes[i];
          flame.style.left = '50%';
          flame.style.bottom = '28px';
          flame.style.position = 'absolute';
          flame.style.animation = `flicker ${0.7 + i * 0.4}s ease-in-out infinite`;
          flame.style.transformOrigin = 'bottom center';
          torch.appendChild(flame);
        }
      }

      // Dark mode toggle
      const modeToggleBtn = document.getElementById('mode-toggle');
      modeToggleBtn.addEventListener('click', () => {
        const isDark = document.body.classList.toggle('dark-mode');
        localStorage.setItem('darkMode', isDark);
      });
      if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
      }

      // Search bar toggle and logic
      const searchToggleBtn = document.getElementById('search-toggle');
      const searchBar = document.getElementById('search-bar');
      const clearSearchBtn = document.getElementById('clear-search');
      const searchFunny = document.getElementById('search-funny');

      searchBar.style.display = 'none';
      clearSearchBtn.style.display = 'none';
      searchFunny.style.display = 'none';

      searchToggleBtn.addEventListener('click', () => {
        if (searchBar.style.display === 'inline-block') {
          searchBar.style.display = 'none';
          clearSearchBtn.style.display = 'none';
          searchFunny.style.display = 'none';
          searchBar.value = '';
        } else {
          searchBar.style.display = 'inline-block';
          searchBar.focus();
        }
      });

      clearSearchBtn.addEventListener('click', () => {
        searchBar.value = '';
        clearSearchBtn.style.display = 'none';
        searchFunny.style.display = 'none';
        searchBar.focus();
      });

      searchBar.addEventListener('input', () => {
        if (searchBar.value.trim() !== '') {
          clearSearchBtn.style.display = 'inline-block';
          const funnyResponses = [
            "Ranting about that, huh?",
            "Searching... but the rant is strong!",
            "Hmm, what would Count Rantula say?",
            "Hold on, conjuring some chaos...",
            "Are you sure you want to know?"
          ];
          const randomResponse = funnyResponses[Math.floor(Math.random() * funnyResponses.length)];
          searchFunny.textContent = randomResponse;
          searchFunny.style.display = 'block';
        } else {
          clearSearchBtn.style.display = 'none';
          searchFunny.style.display = 'none';
        }
      });

      // Toolbar buttons and page loading
      const toolbarButtons = document.querySelectorAll('.toolbar-btn');
      const articlesContainer = document.getElementById('articles-container');
      const articleFullContent = document.getElementById('article-full-content');
      const mainContent = document.getElementById('main-content');

      toolbarButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          toolbarButtons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          const page = btn.getAttribute('data-page');
          loadPage(page);
        });
      });

      function loadPage(page) {
        articleFullContent.style.display = 'none';
        articlesContainer.style.display = 'none';
        mainContent.style.display = 'block';
        searchFunny.style.display = 'none';
        searchBar.style.display = 'none';
        clearSearchBtn.style.display = 'none';
        searchBar.value = '';
        if (page === 'articles') {
          articlesContainer.style.display = 'block';
          mainContent.innerHTML = '';
        } else {
          mainContent.innerHTML = `<div class="textbed"><h2>${page.charAt(0).toUpperCase() + page.slice(1)}</h2><p>Content for the ${page} page.</p></div>`;
        }
        window.scrollTo(0, 0);
      }

      // Article preview click to load full article
      document.querySelectorAll('.article-preview').forEach(preview => {
        preview.addEventListener('click', () => {
          const file = preview.getAttribute('data-file');
          fetch(file).then(response => response.text()).then(html => {
            articleFullContent.innerHTML = html;
            articleFullContent.style.display = 'block';
            articlesContainer.style.display = 'none';
            mainContent.style.display = 'none';
            window.scrollTo(0, 0);
          }).catch(() => {
            articleFullContent.innerHTML = '<p>Failed to load article.</p>';
            articleFullContent.style.display = 'block';
            articlesContainer.style.display = 'none';
            mainContent.style.display = 'none';
          });
        });
      });

      // Back to top button logic
      const backToTopBtn = document.getElementById('back-to-top');
      window.addEventListener('scroll', () => {
        if (window.scrollY > 300) {
          backToTopBtn.style.display = 'block';
          document.getElementById('footnote').style.opacity = '1';
        } else {
          backToTopBtn.style.display = 'none';
          document.getElementById('footnote').style.opacity = '0';
        }
      });
      backToTopBtn.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });

      // Konami code Easter egg
      const konamiCode = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65];
      let konamiPosition = 0;
      window.addEventListener('keydown', (e) => {
        if (e.keyCode === konamiCode[konamiPosition]) {
          konamiPosition++;
          if (konamiPosition === konamiCode.length) {
            alert("They are watching!");
            konamiPosition = 0;
          }
        } else {
          konamiPosition = 0;
        }
      });

      // Show footnote after delay
      setTimeout(() => {
        document.getElementById('footnote').style.opacity = '1';
      }, 5000);

      // Load articles page initially
      loadPage('articles');

      /* ==== FULL JS END ==== */
    });
  </script>
</body>
</html>
